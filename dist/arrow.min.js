function App(){}function EmptyFn(){}App.Base=new Class({initialize:function(){}}),App.view=App.view||{},App.view.Compass=new Class(App.View),App.view.Compass.extend({directionArrowEl:"#direction .direction-arrow",headingEl:"#heading",compassShieldEl:"#compass .shield",headDirectionArrow:function(a){var b=this,c=DestinationLocation.getValue("bearing");$(b.compassShieldEl).css("transform","rotate("+-a+"deg)"),$(b.directionArrowEl).css("transform","rotate("+(-a+c)+"deg)"),$(b.headingEl).text(a.toFixed())},initialize:function(){var a=this;Compass.watch(function(a){return function(b){a.headDirectionArrow.call(a,b)}}(a))}}),App.controller=App.controller||{},App.controller.Controller=new Class(App.Base),App.controller.Controller.extend({initialize:function(a){a=a||{};var b;this.init=a.init||EmptyFn;for(b in a)this[b]=a[b];this.init.call(this)}}),App.controller.Controller.implement([App.Observable]),App.model=App.model||{},App.model.Field=new Class({initialize:function(a){a=a||{},this.name=a.name,a.setter&&(this.setter=a.setter),a.getter&&(this.getter=a.getter),a.value?this.setValue(a.value):a.defaultValue?this.value=a.defaultValue:this.setValue(null)},getValue:function(){return this.hasOwnProperty("getter")?this.getter.call(this,this.value):this.value},getRawValue:function(){return this.value},setValue:function(a){return this.hasOwnProperty("setter")?this.setter.call(this,a):this.setRawValue(a)},setRawValue:function(a){return this.value=a}}),App.model=App.model||{},App.model.LocationModel=new Class(App.model.Model),App.model.LocationModel.extend({initialize:function(a){a.data=a.data||{},a.fields=a.fields||[],a.getters=a.getters||{},a.fields.push("lat"),a.fields.push("lng"),a.fields.push("alt"),a.getters.lat=this.latGetter,a.getters.lng=this.lngGetter,a.getters.alt=this.altGetter,App.model.LocationModel._parent.initialize.call(this,a),this.LatLng=new LatLon(this.getRawValue("lat"),this.getRawValue("lng"))},setCoords:function(a){var b=this.setData({lat:a.latitude,lng:a.longitude,alt:a.altitude||0},!0);return this.LatLng=new LatLon(this.getRawValue("lat"),this.getRawValue("lng")),this.beforeUpdate.apply(this,arguments),this.fireEvent("update"),b},getCoords:function(){return this.LatLng},latGetter:function(){var a=this.getRawValue("lat");return Dms.toLat(a)},lngGetter:function(){var a=this.getRawValue("lng");return Dms.toLon(a)},altGetter:function(){var a=this.getRawValue("alt");return 0==a?"not available":a.toFixed(1)+"m"}}),App.view=App.view||{},App.view.Map=new Class(App.view.View),App.view.Map.extend({mapEl:null,mapCurrentPositionPolygon:{strokeOpacity:.8,strokeWeight:2,fillOpacity:.35,radius:10},mapStyle:null,mapOptions:{disableDefaultUI:!0,scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!1},lat:0,lng:0,zoom:10,model:null,headDirectionArrow:function(a){var b=this,c=DestinationLocation.getValue("bearing");$(b.compassShieldEl).css("transform","rotate("+-a+"deg)"),$(b.directionArrowEl).css("transform","rotate("+(-a+c)+"deg)"),$(b.headingEl).text(a.toFixed())},initialize:function(a){var b=this;a=a||{},b.mapEl=a.mapEl||b.mapEl,b.mapStyle=a.mapStyle||b.mapStyle,b.mapOptions=a.mapOptions||b.mapOptions,b.lat=a.lat||b.lat,b.lng=a.lng||b.lng,b.zoom=a.zoom||b.zoom,b.mapCurrentPositionPolygon=a.mapCurrentPositionPolygon||b.mapCurrentPositionPolygon,b.model=a.model||b.model,b.renderMap(b.lat,b.lng,b.zoom),b.model=b.model||new App.model.LocationModel({}),b.model.addEventListener("update",b.onLocationUpdate,b),App.model.LocationModel._parent.initialize.call(this,a)},onLocationUpdate:function(a){var b=a.getCoors();return me.updateMap(b.lat,b.lat,me.zoom,me.zoom)},renderMap:function(a,b,c){var d=this,e=d.mapOptions||{},f=new google.maps.LatLng(a,b);e.styles=e.styles||d.mapStyle||[],e.zoom=c||e.zoom||d.zoom,d.map=new google.maps.Map(document.querySelector(d.mapEl),e),d.map.setCenter(f),d.map.setZoom(c),d.mapCurrentPositionPolygon=new google.maps.Circle(d.mapCurrentPositionPolygon),d.mapCurrentPositionPolygon.setCenter(f),d.mapCurrentPositionPolygon.setMap(d.map)},updateMap:function(a,b,c,d){var e=this,f=new google.maps.LatLng(a,b);e.map.setCenter(f),e.map.setZoom(d||10),e.mapCurrentPositionPolygon.setCenter(f),e.mapCurrentPositionPolygon.setRadius(radius||100)},setLocation:function(a,b,c,d){var e=this;return e.updateMap(a,b,c||e.zoom,d||1e3),e}}),App.model=App.model||{},App.model.Model=new Class(App.Base),App.model.Model.implement([App.Observable]),App.model.Model.extend({initialize:function(a){a=a||{};var b,c;this.addEvent("update");for(b in a.fields)c=a.fields[b],this.addField({name:c,setter:(a.setters||{})[c],getter:(a.getters||{})[c],defaultValue:(a.defaultvalues||{})[c]});a.data&&this.setData(a.data,!0)},addField:function(a){this.fields||(this.fields={}),this.fields[a.name]=new App.model.Field(a)},setValue:function(a,b,c){var d;if(!this.fields.hasOwnProperty(a))throw"field does not exist";return d=this.fields[a],b=d.setValue(b),c||this.fireEvent("update"),b},setRawVaue:function(a,b,c){if(!this.fields.hasOwnProperty(a))throw"field does not exist";return field=this.fields[a],this.fields[a].setRawValue(b),c||this.fireEvent("update"),b},getValue:function(a){var b=this.fields[a];return b.getValue()},getRawValue:function(a){return this.fields[a].getRawValue()},setData:function(a,b){var c;for(c in a)this.setValue(c,a[c],b);return this},setRawValue:function(a){var b;for(b in a)this.setRawValue(b,a[name]);return this},beforeUpdate:function(){}}),App.Observable={addEvent:function(a){this.events||(this.events={}),this.events[a]=this.events[a]||[]},addEventListener:function(a,b,c){var d=c||this;return this.events[a].push({fn:b,scope:d}),this},removeEventListener:function(a,b){var c,d;if(this.events.hasOwnProperty(a))for(d=this.events[a],c=d.length-1;--c;)d[c].fn===b&&array.splice(c,1);return this},fireEvent:function(a){var b=this,c=!0;return this.events[a].forEach(function(a){a.hasOwnProperty("fn")?a.fn.call(a.scope,b)===!1&&(c=!1):a.call(b,b)===!1&&(c=!1)}),c}},App.view=App.view||{},App.view.View=new Class(App.Base),App.view.View.extend({initialize:function(a){a=a||{},this.el="string"==typeof a.el?document.querySelector(a.el):a.el,App.view.View._parent.initialize.call(this,a)}}),App.view.View.implement([App.Observable]);